(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{493:function(e,r,t){"use strict";t.r(r);var a=t(4),s=Object(a.a)({},(function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("p",[t("a",{attrs:{href:"https://github.com/lightlitebug/weather_riverpod_extended",target:"_blank",rel:"noopener noreferrer"}},[e._v("weather_riverpod_extended"),t("OutboundLink")],1),e._v(" 는 "),t("code",[e._v("헤비프렌")]),e._v("님의 강의를 정리한 내용입니다.")]),e._v(" "),t("blockquote",[t("p",[e._v("provider는 기본적으로 싱글톤")])]),e._v(" "),t("h2",{attrs:{id:"프로세스"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#프로세스"}},[e._v("#")]),e._v(" 프로세스")]),e._v(" "),t("ol",[t("li",[e._v("** home ** 에서 ** 검색 ** 버튼을 클릭하면 "),t("code",[e._v("SearchPage")]),e._v("로 이동")]),e._v(" "),t("li",[t("code",[e._v("SearchPage")]),e._v("에서 도시를 입력 후 버튼을 클릭하면 도시명을 ** home ** 화면으로 리턴")]),e._v(" "),t("li",[e._v("** home ** 화면에서 도시명을 받고 "),t("code",[e._v("cityProvider.state")]),e._v("에 도시명을 저장")]),e._v(" "),t("li",[t("code",[e._v("currentWeatherProvider")]),e._v("로 외부 날짜 api 호출")]),e._v(" "),t("li",[t("code",[e._v("ProviderListener")]),e._v("로 weather의 변경이 감지되고 에러면 AlertDialog를 보여주고 아니면 "),t("code",[e._v("Consumer")]),e._v("로 날씨를 보여 줌")])]),e._v(" "),t("h2",{attrs:{id:"cityprovider"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cityprovider"}},[e._v("#")]),e._v(" cityProvider")]),e._v(" "),t("p",[e._v("입력 받은 도시의 상태 관리를 위한 StateProvider 생성")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("import 'package:flutter_riverpod/flutter_riverpod.dart';\n\nfinal cityProvider = StateProvider<String>((ref) {\n  return '';\n});\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br")])]),t("blockquote",[t("p",[e._v("초기값은 ''")])]),e._v(" "),t("h2",{attrs:{id:"weather-api-provider"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#weather-api-provider"}},[e._v("#")]),e._v(" weather api provider")]),e._v(" "),t("ol",[t("li",[t("code",[e._v("WeatherApiClient")]),e._v("는 도시이름으로 http로 날찌 정보를 가져옴")]),e._v(" "),t("li",[t("code",[e._v("WeatherRepository")]),e._v("는 "),t("code",[e._v("cityProvider")]),e._v("로 도시를 가져오고 "),t("code",[e._v("weatherApiClientProvider")]),e._v("로 날짜를 조회 하여 리턴")])]),e._v(" "),t("h3",{attrs:{id:"weatherapiclientprovider"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#weatherapiclientprovider"}},[e._v("#")]),e._v(" weatherApiClientProvider")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("final weatherApiClientProvider = Provider<WeatherApiClient>((ref) {\n  print('>>> In weatherApiClientProvider');\n  return WeatherApiClient(httpClient: http.Client());\n});\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br")])]),t("h3",{attrs:{id:"weatherrepository"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#weatherrepository"}},[e._v("#")]),e._v(" WeatherRepository")]),e._v(" "),t("p",[t("code",[e._v("Reader")]),e._v("를 파라미터로 받아서, provider를 사용함")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("import 'package:flutter_riverpod/flutter_riverpod.dart';\nimport '../models/weather.dart';\nimport '../providers/providers.dart';\n\nclass WeatherRepository {\n  final Reader read;\n\n  WeatherRepository({this.read});\n\n  Future<Weather> getWeather() async {\n    final String city = read(cityProvider).state;\n\n    try {\n      final int locationId =\n          await read(weatherApiClientProvider).getLocationId(city);\n\n      return await read(weatherApiClientProvider).fetchWeather(locationId);\n    } catch (e) {\n      throw e.toString();\n    }\n  }\n}\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br"),t("span",{staticClass:"line-number"},[e._v("11")]),t("br"),t("span",{staticClass:"line-number"},[e._v("12")]),t("br"),t("span",{staticClass:"line-number"},[e._v("13")]),t("br"),t("span",{staticClass:"line-number"},[e._v("14")]),t("br"),t("span",{staticClass:"line-number"},[e._v("15")]),t("br"),t("span",{staticClass:"line-number"},[e._v("16")]),t("br"),t("span",{staticClass:"line-number"},[e._v("17")]),t("br"),t("span",{staticClass:"line-number"},[e._v("18")]),t("br"),t("span",{staticClass:"line-number"},[e._v("19")]),t("br"),t("span",{staticClass:"line-number"},[e._v("20")]),t("br"),t("span",{staticClass:"line-number"},[e._v("21")]),t("br"),t("span",{staticClass:"line-number"},[e._v("22")]),t("br")])]),t("h3",{attrs:{id:"weatherrepositoryprovider"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#weatherrepositoryprovider"}},[e._v("#")]),e._v(" weatherRepositoryProvider")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("final weatherRepositoryProvider = Provider<WeatherRepository>((ref) {\n  print('>>> In weatherRepositoryProvider');\n  return WeatherRepository(read: ref.read);\n});\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br")])]),t("h2",{attrs:{id:"weatherstateprovider"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#weatherstateprovider"}},[e._v("#")]),e._v(" weatherStateProvider")]),e._v(" "),t("p",[e._v("최종적으로 날씨 state를 리턴해주는 provider")]),e._v(" "),t("h3",{attrs:{id:"weatherstate"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#weatherstate"}},[e._v("#")]),e._v(" WeatherState")]),e._v(" "),t("p",[e._v("날씨를 가져오는 상태를 관리. 로딩중인지, 날씨가 있는지, 에러가 발생하지 않았는지..\nUI에서 로딩중이면 로딩바, 날씨가 있으면 날씨를 보여주고, 에러가 있으면 다이어로그로 표시 해 줌")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("class WeatherState {\n  final bool loading;\n  final Weather weather;\n  final String error;\n\n  WeatherState({\n    this.loading,\n    this.weather,\n    this.error,\n  });\n\n  WeatherState copyWith({\n    bool loading,\n    Weather weather,\n    String error,\n  }) {\n    return WeatherState(\n      loading: loading ?? this.loading,\n      weather: weather ?? this.weather,\n      error: error ?? this.error,\n    );\n  }\n}\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br"),t("span",{staticClass:"line-number"},[e._v("11")]),t("br"),t("span",{staticClass:"line-number"},[e._v("12")]),t("br"),t("span",{staticClass:"line-number"},[e._v("13")]),t("br"),t("span",{staticClass:"line-number"},[e._v("14")]),t("br"),t("span",{staticClass:"line-number"},[e._v("15")]),t("br"),t("span",{staticClass:"line-number"},[e._v("16")]),t("br"),t("span",{staticClass:"line-number"},[e._v("17")]),t("br"),t("span",{staticClass:"line-number"},[e._v("18")]),t("br"),t("span",{staticClass:"line-number"},[e._v("19")]),t("br"),t("span",{staticClass:"line-number"},[e._v("20")]),t("br"),t("span",{staticClass:"line-number"},[e._v("21")]),t("br"),t("span",{staticClass:"line-number"},[e._v("22")]),t("br"),t("span",{staticClass:"line-number"},[e._v("23")]),t("br")])]),t("h3",{attrs:{id:"currentweatherprovider"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#currentweatherprovider"}},[e._v("#")]),e._v(" currentWeatherProvider")]),e._v(" "),t("p",[t("code",[e._v("weatherRepositoryProvider")]),e._v("로 날씨를 가져오고 "),t("code",[e._v("CurrentWeather")]),e._v("의 상태를 새로 만듬")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("final currentWeatherProvider = StateNotifierProvider<CurrentWeather>((ref) {\n  print('>>> In currentWeatherProvicer');\n  return CurrentWeather(ref.read);\n});\n\nclass CurrentWeather extends StateNotifier<WeatherState> {\n  final Reader read;\n\n  static WeatherState initialWeatherState = WeatherState();\n\n  CurrentWeather(this.read) : super(initialWeatherState);\n\n  Future<void> fetchWeather() async {\n    state = state.copyWith(loading: true, error: '');\n    final String city = read(cityProvider).state;\n\n    try {\n      final Weather weather =\n          await read(weatherRepositoryProvider).getWeather();\n      state = state.copyWith(\n        loading: false,\n        weather: weather,\n        error: '',\n      );\n    } catch (e) {\n      state = state.copyWith(\n        loading: false,\n        error: 'Can not fetch the weather of $city',\n      );\n    }\n  }\n}\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br"),t("span",{staticClass:"line-number"},[e._v("11")]),t("br"),t("span",{staticClass:"line-number"},[e._v("12")]),t("br"),t("span",{staticClass:"line-number"},[e._v("13")]),t("br"),t("span",{staticClass:"line-number"},[e._v("14")]),t("br"),t("span",{staticClass:"line-number"},[e._v("15")]),t("br"),t("span",{staticClass:"line-number"},[e._v("16")]),t("br"),t("span",{staticClass:"line-number"},[e._v("17")]),t("br"),t("span",{staticClass:"line-number"},[e._v("18")]),t("br"),t("span",{staticClass:"line-number"},[e._v("19")]),t("br"),t("span",{staticClass:"line-number"},[e._v("20")]),t("br"),t("span",{staticClass:"line-number"},[e._v("21")]),t("br"),t("span",{staticClass:"line-number"},[e._v("22")]),t("br"),t("span",{staticClass:"line-number"},[e._v("23")]),t("br"),t("span",{staticClass:"line-number"},[e._v("24")]),t("br"),t("span",{staticClass:"line-number"},[e._v("25")]),t("br"),t("span",{staticClass:"line-number"},[e._v("26")]),t("br"),t("span",{staticClass:"line-number"},[e._v("27")]),t("br"),t("span",{staticClass:"line-number"},[e._v("28")]),t("br"),t("span",{staticClass:"line-number"},[e._v("29")]),t("br"),t("span",{staticClass:"line-number"},[e._v("30")]),t("br"),t("span",{staticClass:"line-number"},[e._v("31")]),t("br"),t("span",{staticClass:"line-number"},[e._v("32")]),t("br")])]),t("h3",{attrs:{id:"weatherstateprovider-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#weatherstateprovider-2"}},[e._v("#")]),e._v(" weatherStateProvider")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("final weatherStateProvider = Provider<WeatherState>((ref) {\n  print('>>> In weatherStateProvider');\n  final WeatherState weather = ref.watch(currentWeatherProvider.state);\n\n  return weather;\n});\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br")])]),t("h2",{attrs:{id:"참고"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#참고"}},[e._v("#")]),e._v(" 참고")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://www.youtube.com/watch?v=AjcpfvoyV-Y&list=PLGJ958IePUyBVpGmJA1hSwB8_j1gU0kWq",target:"_blank",rel:"noopener noreferrer"}},[e._v("Riverpod [1] - New wave of state management in flutter"),t("OutboundLink")],1),e._v(" "),t("a",{attrs:{href:"https://www.youtube.com/watch?v=vGG-fjURbRI&list=PLGJ958IePUyBVpGmJA1hSwB8_j1gU0kWq&index=2",target:"_blank",rel:"noopener noreferrer"}},[e._v("Riverpod [2] - Real-life example - Simplified Weather App"),t("OutboundLink")],1),e._v(" "),t("a",{attrs:{href:"https://www.youtube.com/watch?v=glFBu3_ax_Q&list=PLGJ958IePUyBVpGmJA1hSwB8_j1gU0kWq&index=3",target:"_blank",rel:"noopener noreferrer"}},[e._v("Riverpod [3-1] - initState, Authentication, Flavor, Pull To Refresh"),t("OutboundLink")],1),e._v(" "),t("a",{attrs:{href:"https://www.youtube.com/watch?v=MMdr80t-2U4&list=PLGJ958IePUyBVpGmJA1hSwB8_j1gU0kWq&index=4",target:"_blank",rel:"noopener noreferrer"}},[e._v("Riverpod [3-2] - initState, Authentication, Flavor, Pull To Refresh\n"),t("OutboundLink")],1),e._v(" "),t("a",{attrs:{href:"https://www.youtube.com/watch?v=n3pEMZAiGD8&list=PLGJ958IePUyBVpGmJA1hSwB8_j1gU0kWq&index=5",target:"_blank",rel:"noopener noreferrer"}},[e._v("Riverpod [3-3] - initState, Authentication, Flavor, Pull To Refresh"),t("OutboundLink")],1)])])}),[],!1,null,null,null);r.default=s.exports}}]);